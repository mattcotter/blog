---
import NavLayout from '../layouts/NavLayout.astro';
import fs from 'fs';
import path from 'path';
import matter from 'gray-matter';

const pageTitle = "Matt Cotte || ✍️ Blog";
const blogDir = './src/pages/blog';
const files = fs.readdirSync(blogDir).filter(file => file.endsWith('.md'));

// Parse frontmatter
const posts = files.map(file => {
  const filePath = path.join(blogDir, file);
  const content = fs.readFileSync(filePath, 'utf-8');
  const { data } = matter(content);

  return {
    ...data,
    url: `/blog/${file.replace('.md', '')}`,
  };
});
---

<NavLayout pageTitle={pageTitle}>
    <div class="text-lg md:text-xl space-y-4 bg-white mt-5 pt-5 pl-10 pb-5 rounded-4xl text-black box-shadow">
      <h1 class="text-3xl font-bold">Blog</h1>
    </div>
    <ul class="space-y-4">
    {posts.map(post => (
        <li>
        <a href={post.url} class="text-xl text-blue-600 hover:underline">
            {post.title}
        </a>
        <p class="text-sm text-gray-500">{new Date(post.pubDate).toLocaleDateString()}</p>
        </li>
    ))}
    </ul>
</NavLayout>



