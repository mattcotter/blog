---
import NavLayout from '../layouts/NavLayout.astro';
import ImageRotator from '../components/ImageRotator.astro';
import type { MarkdownInstance } from 'astro';

interface BlogPostFrontmatter {
  pubDate: string;
  title: string;
  description?: string;
}

const pageTitle = "Matt Cotter";

// Get all blog posts
const allPosts = Object.values(import.meta.glob('./blog/*.md', { eager: true }));

const sortedPosts = allPosts.sort((a, b) => {
  const dateA = new Date(a.frontmatter.pubDate);
  const dateB = new Date(b.frontmatter.pubDate);
  return dateB.getTime() - dateA.getTime();
});

const latestPosts = sortedPosts.slice(0, 2);
---

<NavLayout pageTitle={pageTitle}>
  <ImageRotator />

  <div class="max-w-3xl py-6 flex justify-between rounded-4xl m-5 p-5">
    <h2 class="text-2xl font-bold">Latest Posts</h2>
    <a href="/blog" class="inline-block px-6 py-2">
      View Posts
    </a>
  </div>

  <div class="max-w-3xl ml-5 flex gap-4">
	{latestPosts.map(post => (
	  <a 
		href={post.url} 
		class="space-y-1 bg-white/5 text-white pl-5 pt-5 pr-5 relative rounded-4xl box-shadow border-1 border-black"
	  >
		<!-- Top-left corner icon -->
		<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="absolute top-3 right-3 w-5 h-5 text-blue-400 opacity-70 group-hover:opacity-100 pointer-events-none">
			<path stroke-linecap="round" stroke-linejoin="round" d="m4.5 19.5 15-15m0 0H8.25m11.25 0v11.25" />
		</svg>

		<div class="pl-2"> 
		  <span class="text-lg font-semibold text-blue-300 mb-1">{post.frontmatter.title}</span><br />
		  <small class="text-xs text-gray-400">{new Date(post.frontmatter.pubDate).toLocaleDateString()}</small>
		  {post.frontmatter.description && (
			<p class="text-gray-300 mt-2 text-sm">{post.frontmatter.description}</p>
		  )}
		</div>
	  </a>
	))}
  </div>
</NavLayout>
