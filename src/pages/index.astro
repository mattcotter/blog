---
import NavLayout from '../layouts/NavLayout.astro';
import ImageRotator from '../components/ImageRotator.astro';
import type { MarkdownInstance } from 'astro';

interface BlogPostFrontmatter {
  pubDate: string;
  title: string;
  description?: string;
}

const pageTitle = "Matt Cotter";

// Get all blog posts
const allPosts = Object.values(import.meta.glob('../pages/posts/*.md', { eager: true })) as MarkdownInstance<BlogPostFrontmatter>[];

const sortedPosts = allPosts.sort((a, b) => {
  const dateA = new Date(a.frontmatter.pubDate);
  const dateB = new Date(b.frontmatter.pubDate);
  return dateB.getTime() - dateA.getTime();
});

const latestPosts = sortedPosts.slice(0, 2);
---

<NavLayout pageTitle={pageTitle}>
  <ImageRotator />
  
  <!-- <hr class="border-t-2 mt-2 mb-1 border-blue-400" /> -->

  <div class="max-w-3xl py-6 flex justify-between items-center">
    <h2 class="text-2xl font-bold">Latest Posts</h2>
    <a href="/blog" class="inline-block px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition">
      View Posts
    </a>
  </div>

  <div class="max-w-3xl flex gap-4">
    {latestPosts.map(post => (
      <div class="w-1/2 border-t-2 border-r-2 border-blue-400 rounded-tr-lg p-4">
        <a href={post.url} class="text-lg font-semibold text-blue-300 hover:underline">
          {post.frontmatter.title}
        </a>
        <p class="text-sm text-gray-400">{new Date(post.frontmatter.pubDate).toLocaleDateString()}</p>
        {post.frontmatter.description && (
          <p class="text-gray-300 mt-1">{post.frontmatter.description}</p>
        )}
      </div>
    ))}
  </div>
</NavLayout>
